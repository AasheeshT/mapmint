#import mapscript
#import mapfile.service as mmap
#if $layer.metadata.get("ows_title") is not None and $layer.metadata.get("ows_title")!=""
#set title=$layer.metadata.get("ows_title")
#else
#set title=$layer.name
#end if
#try
#set p=$prefix
#except
#set p=""
#end try
#if $layer.metadata.get("cstep") is not None
#set prefix="_step"+$layer.metadata.get("cstep")
#set hasStep=True
#else
#set prefix=""
#set hasStep=False
#end if
#if $layer.metadata.get('mm_group')!="Layers"
#if $layer.numclasses > 1 and $layer.metadata.get('mmClass')!="tl"
    <li id="layer_$(layer.index)$prefix" iconCls="tree$(p)_layer$(layer.index)$prefix" #if not(hasStep)#state="closed"#end if# class="list-group-item layer cm"><input type="checkbox" #if $layer.map.web.metadata.get("mmActivatedLayers").split(",").count($layer.name)>0#checked="checked"#end if# /><label class="tree-toggle tree-parent"><span class="fa fa-caret-square-o-down tree-node text-center ud"></span>$title </label>
    	<ul class="list-group tree">
#for j in range(0,$layer.numclasses)
     	<li iconCls="tree_layer_class tree$(p)_layer$(layer.index)$(prefix)_class$j" class="list-group-item"><label><i class="fa layer_$(layer.index)_class$j"></i> $layer.getClass($j).name</label></li>
#end for
	    </ul>
	  </li>
#else
	<li id="layer_$(layer.index)" iconCls="tree$(p)_layer$(layer.index)$prefix" class="list-group-item layer cm"><input type="checkbox" #if $layer.map.web.metadata.get("mmActivatedLayers").split(",").count($layer.name)>0#checked="checked"#end if# /><label><i class="fa fa-circle"></i> $title</label></li>
#end if
#end if